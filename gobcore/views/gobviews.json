{
  "meetbouten": {
    "meetbouten": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT  meetbouten.identificatie",
          "    ,       meetbouten.geometrie",
          "    ,       meetbouten.locatie",
          "    ,       bouwblokken.code                                                AS bouwblok",
          "    ,       buurten.code                                                    AS buurt",
          "    ,       stadsdelen.code                                                 AS stadsdeel",
          "    ,       eerste_metingen.datum                                           AS datum",
          "    ,       meest_recente_metingen.hoogte_tov_nap",
          "    ,       meest_recente_metingen.zakkingssnelheid",
          "    ,       meest_recente_metingen.zakking_cumulatief",
          "    ,       nabij_nummeraanduiding->>'bronwaarde'                           AS adres",
          "    ,       CASE WHEN status->>'id' = '1' THEN 'A'",
          "              WHEN status->>'id' = '2' THEN 'A'",
          "              WHEN status->>'id' = '3' THEN 'V'",
          "            END                                                             AS status_id",
          "            FROM              meetbouten_meetbouten                         AS meetbouten",
          "            LEFT JOIN (",
          "              SELECT identificatie, code FROM gebieden_bouwblokken",
          "              WHERE datum_einde_geldigheid IS NULL) AS bouwblokken on meetbouten.ligt_in_bouwblok->>'id' = bouwblokken.identificatie",
          "            LEFT JOIN (",
          "              SELECT identificatie, code FROM gebieden_buurten",
          "              WHERE datum_einde_geldigheid IS NULL) AS buurten on meetbouten.ligt_in_buurt->>'id' = buurten.identificatie",
          "            LEFT JOIN (",
          "              SELECT identificatie, code FROM gebieden_stadsdelen",
          "              WHERE datum_einde_geldigheid IS NULL) AS stadsdelen on meetbouten.ligt_in_stadsdeel->>'id' = stadsdelen.identificatie",
          "            LEFT JOIN (",
          "              SELECT DISTINCT ON (hoort_bij_meetbout->>'id') * from meetbouten_metingen",
          "              ORDER BY hoort_bij_meetbout->>'id', datum ASC",
          "            ) AS eerste_metingen ON meetbouten._id = eerste_metingen.hoort_bij_meetbout->>'id'",
          "            LEFT JOIN (",
          "              SELECT DISTINCT ON (hoort_bij_meetbout->>'id') * from meetbouten_metingen",
          "              ORDER BY hoort_bij_meetbout->>'id', datum DESC",
          "            ) AS meest_recente_metingen ON meetbouten._id = meest_recente_metingen.hoort_bij_meetbout->>'id'",
          "    WHERE meetbouten.publiceerbaar = TRUE"
        ]
      }
    },
    "metingen": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT metingen.identificatie",
          "    ,       datum",
          "    ,       type_meting",
          "    ,       hoogte_tov_nap",
          "    ,       zakking",
          "    ,       zakkingssnelheid",
          "    ,       zakking_cumulatief",
          "    ,       is_gemeten_door",
          "    ,       (hoeveelste_meting - 1)                                   AS hoeveelste_meting",
          "    ,       hoort_bij_meetbout->>'id'                                 AS hoort_bij_meetbout",
          "    ,       refereert_aan->0->>'id'                                   AS refp1_nr",
          "    ,       refereert_aan->1->>'id'                                   AS refp2_nr",
          "    ,       refereert_aan->2->>'id'                                   AS refp3_nr",
          "    ,       CASE WHEN aantal_dagen::TEXT = '0' THEN ''::TEXT",
          "                 ELSE aantal_dagen::TEXT",
          "            END                                                       AS aantal_dagen",
          "    ,       CASE WHEN wijze_van_inwinnen->>'id' = '1' THEN 'W'",
          "                 WHEN wijze_van_inwinnen->>'id' = '2' THEN 'T'",
          "                 WHEN wijze_van_inwinnen->>'id' = '3' THEN 'G' END    AS wvi",
          "    ,       stadsdelen.code                                           AS stadsdeel",
          "    FROM  meetbouten_metingen                                         AS metingen",
          "    LEFT JOIN (",
          "            SELECT _id, ligt_in_stadsdeel->>'id' AS ligt_in_stadsdeel FROM meetbouten_meetbouten",
          "    ) AS meetbouten ON metingen.hoort_bij_meetbout->>'id' = meetbouten._id",
          "    LEFT JOIN (",
          "            SELECT identificatie, code FROM gebieden_stadsdelen",
          "            WHERE datum_einde_geldigheid IS NULL) AS stadsdelen on meetbouten.ligt_in_stadsdeel = stadsdelen.identificatie",
          "    WHERE metingen.publiceerbaar = TRUE"
        ]
      }
    },
    "referentiepunten": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT identificatie",
          "    ,      geometrie",
          "    ,      hoogte_tov_nap",
          "    ,      datum",
          "    ,      CONCAT_WS(' ', nabij_nummeraanduiding->>'bronwaarde', locatie)       AS locatie",
          "    FROM  meetbouten_referentiepunten",
          "    WHERE publiceerbaar = TRUE"
        ]
      }
    },
    "rollagen": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT meetbouten_rollagen.identificatie",
          "    ,       ROW_NUMBER() OVER (order by meetbouten_rollagen.identificatie) AS idx",
          "    ,       ST_centroid(bouwblokken.geometrie) AS geometrie",
          "    FROM  meetbouten_rollagen",
          "        LEFT JOIN",
          "            gebieden_bouwblokken AS bouwblokken",
          "            ON meetbouten_rollagen.identificatie = bouwblokken.code",
          "    ORDER BY meetbouten_rollagen.identificatie"
        ]
      }
    }
  },
  "nap": {
    "peilmerken": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT identificatie",
          "    ,      hoogte_tov_nap",
          "    ,      jaar",
          "    ,      merk->>'id'                                                 AS merk_id",
          "    ,      omschrijving",
          "    ,      windrichting",
          "    ,      x_coordinaat_muurvlak",
          "    ,      y_coordinaat_muurvlak",
          "    ,      rws_nummer",
          "    ,      geometrie",
          "    FROM  nap_peilmerken",
          "    WHERE publiceerbaar = TRUE"
        ]
      }
    }
  },
  "gebieden": {
    "bouwblokken": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT",
          "        bouwblokken.identificatie",
          "    ,   bouwblokken.code",
          "    ,   bouwblokken.datum_begin_geldigheid",
          "    ,   bouwblokken.datum_einde_geldigheid",
          "    ,   buurten.identificatie AS buurtidentificatie",
          "    ,   buurten.code AS buurtcode",
          "    ,   buurten.naam AS buurtnaam",
          "    ,   wijken.identificatie AS wijkidentificatie",
          "    ,   wijken.code AS wijkcode",
          "    ,   wijken.naam AS wijknaam",
          "    ,   NULL AS ggw_identificatie",
          "    ,   NULL AS ggw_code",
          "    ,   NULL AS ggw_naam",
          "    ,   NULL AS ggp_identificatie",
          "    ,   NULL AS ggp_code",
          "    ,   NULL AS ggp_naam",
          "    ,   stadsdelen.identificatie AS stadsdeelidentificatie",
          "    ,   stadsdelen.code AS stadsdeelcode",
          "    ,   stadsdelen.naam AS stadsdeelnaam",
          "    ,   NULL AS brk_gemeenteidentificatie",
          "    ,   NULL AS brk_gemeentenaam",
          "    ,   bouwblokken.geometrie",
          "    FROM",
          "        gebieden_bouwblokken AS bouwblokken",
          "        LEFT JOIN",
          "            (SELECT",
          "                identificatie",
          "            ,   code",
          "            ,   naam",
          "            ,   datum_einde_geldigheid",
          "            ,   ligt_in_wijk",
          "            FROM gebieden_buurten",
          "            WHERE datum_einde_geldigheid IS NULL",
          "            ) AS buurten",
          "        ON bouwblokken.ligt_in_buurt->>'id' = buurten.identificatie",
          "        LEFT JOIN",
          "            (SELECT",
          "                identificatie",
          "            ,   code",
          "            ,   naam",
          "            ,   datum_einde_geldigheid",
          "            ,   ligt_in_stadsdeel",
          "            FROM gebieden_wijken",
          "            WHERE datum_einde_geldigheid IS NULL",
          "            ) AS wijken",
          "            ON buurten.ligt_in_wijk->>'id' = wijken.identificatie",
          "        LEFT JOIN",
          "            (SELECT",
          "                identificatie",
          "            ,   code",
          "            ,   naam",
          "            ,   datum_einde_geldigheid",
          "            FROM gebieden_stadsdelen",
          "            WHERE datum_einde_geldigheid IS NULL",
          "            ) AS stadsdelen",
          "            ON wijken.ligt_in_stadsdeel->>'id' = stadsdelen.identificatie",
          "    WHERE bouwblokken.datum_einde_geldigheid IS NULL"
        ]
      }
    },
    "buurten": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT",
          "        buurten.identificatie",
          "    ,   buurten.code",
          "    ,   buurten.naam",
          "    ,   buurten.datum_begin_geldigheid",
          "    ,   buurten.datum_einde_geldigheid",
          "    ,   buurten.documentdatum",
          "    ,   buurten.documentnummer",
          "    ,   buurten.cbs_code",
          "    ,   wijken.identificatie AS wijkidentificatie",
          "    ,   wijken.code AS wijkcode",
          "    ,   wijken.naam AS wijknaam",
          "    ,   NULL AS ggw_identificatie",
          "    ,   NULL AS ggw_code",
          "    ,   NULL AS ggw_naam",
          "    ,   NULL AS ggp_identificatie",
          "    ,   NULL AS ggp_code",
          "    ,   NULL AS ggp_naam",
          "    ,   stadsdelen.identificatie AS stadsdeelidentificatie",
          "    ,   stadsdelen.code AS stadsdeelcode",
          "    ,   stadsdelen.naam AS stadsdeelnaam",
          "    ,   NULL AS brk_gemeenteidentificatie",
          "    ,   NULL AS brk_gemeentenaam",
          "    ,   buurten.geometrie",
          "    FROM",
          "        gebieden_buurten AS buurten",
          "        LEFT JOIN",
          "            (SELECT",
          "                identificatie",
          "            ,   code",
          "            ,   naam",
          "            ,   datum_einde_geldigheid",
          "            ,   ligt_in_stadsdeel",
          "            FROM gebieden_wijken",
          "            WHERE datum_einde_geldigheid IS NULL",
          "            ) AS wijken",
          "            ON buurten.ligt_in_wijk->>'id' = wijken.identificatie",
          "        LEFT JOIN",
          "            (SELECT",
          "                identificatie",
          "            ,   code",
          "            ,   naam",
          "            ,   datum_einde_geldigheid",
          "            FROM gebieden_stadsdelen",
          "            WHERE datum_einde_geldigheid IS NULL",
          "            ) AS stadsdelen",
          "            ON wijken.ligt_in_stadsdeel->>'id' = stadsdelen.identificatie",
          "    WHERE buurten.datum_einde_geldigheid IS NULL",
          "    ORDER BY buurten.code"
        ]
      }
    },
    "wijken": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT",
          "        wijken.identificatie",
          "    ,   wijken.code",
          "    ,   wijken.naam",
          "    ,   wijken.datum_begin_geldigheid",
          "    ,   wijken.datum_einde_geldigheid",
          "    ,   wijken.documentdatum",
          "    ,   wijken.documentnummer",
          "    ,   wijken.cbs_code",
          "    ,   NULL AS ggw_identificatie",
          "    ,   NULL AS ggw_code",
          "    ,   NULL AS ggw_naam",
          "    ,   stadsdelen.identificatie AS stadsdeelidentificatie",
          "    ,   stadsdelen.code AS stadsdeelcode",
          "    ,   stadsdelen.naam AS stadsdeelnaam",
          "    ,   NULL AS brk_gemeenteidentificatie",
          "    ,   NULL AS brk_gemeentenaam",
          "    ,   wijken.geometrie",
          "    FROM",
          "        gebieden_wijken AS wijken",
          "        LEFT JOIN",
          "            (SELECT",
          "                identificatie",
          "            ,   code",
          "            ,   naam",
          "            ,   datum_einde_geldigheid",
          "            FROM gebieden_stadsdelen",
          "            WHERE datum_einde_geldigheid IS NULL",
          "            ) AS stadsdelen",
          "            ON wijken.ligt_in_stadsdeel->>'id' = stadsdelen.identificatie",
          "    WHERE wijken.datum_einde_geldigheid IS NULL",
          "    ORDER BY wijken.code"
        ]
      }
    },
    "stadsdelen": {
      "enhanced": {
        "version": "0.1",
        "query": [
          "    SELECT",
          "        stadsdelen.identificatie",
          "    ,   stadsdelen.code",
          "    ,   stadsdelen.naam",
          "    ,   stadsdelen.datum_begin_geldigheid",
          "    ,   stadsdelen.datum_einde_geldigheid",
          "    ,   stadsdelen.documentdatum",
          "    ,   stadsdelen.documentnummer",
          "    ,   NULL AS brk_gemeenteidentificatie",
          "    ,   NULL AS brk_gemeentenaam",
          "    ,   stadsdelen.geometrie",
          "    FROM",
          "        gebieden_stadsdelen AS stadsdelen",
          "    WHERE stadsdelen.datum_einde_geldigheid IS NULL",
          "    ORDER BY stadsdelen.code"
        ]
      }
    }
  }
}
